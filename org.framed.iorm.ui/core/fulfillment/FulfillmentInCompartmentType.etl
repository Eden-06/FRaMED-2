import "Fulfillment.etl";

/**
 * transforms fulfillments in a compartment type
 */
@lazy
rule FulfillmentInCompartmentType
	transform s : source!Relation
	to t : Sequence(target!Fulfillment)
	extends Fulfillment {
		guard : not(s.getContainer().getParent()==null) and
				s.getContainer().getParent().getType==(source!Type#CompartmentType)
		
		//get the crom equivalent to compartment type the fulfillment is in
		var compartmentType = s.getContainer.getParent().equivalent();	
		for(fulfillment : target!Fulfillment in t) {
			compartmentType.getFulfillments.add(fulfillment);	
		}
}